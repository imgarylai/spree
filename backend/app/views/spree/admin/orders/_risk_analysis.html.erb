<div id="risk_analysis" class="card mb-3">
  <div class="card-header">
    <h1 class="flex-wrap align-items-center card-title mb-0 h5">
      <%= "#{Spree.t(:risk_analysis)}" %>
    </h1>
  </div>
  <div class="table-responsive">
    <table class="table table-condensed table-bordered">
      <tbody>
        <tr>
          <td><strong><%= Spree.t('risk')%></strong></td>
          <td><%= "#{Spree.t(:not) unless @order.is_risky?} #{Spree.t(:risky)}" %></td>
        </tr>
        <tr>
          <td><strong><%= Spree.t(:failed_payment_attempts) %>:</strong></td>
          <td>
            <span class="badge badge-<%= @order.payments.failed.size > 0 ? 'void' : 'complete' %>">
              <%= link_to "#{Spree.t 'payments_count', count: @order.payments.failed.size, default: pluralize(@order.payments.failed.size, Spree.t(:payment))}", spree.admin_order_payments_path(@order) %>
            </span>
          </td>
        </tr>
        <tr>
          <td><strong><%= Spree.t(:avs_response) %>:</strong></td>
          <td>
            <span class="badge badge-<%= latest_payment.is_avs_risky? ? 'void' : 'complete' %>">
              <% if latest_payment.is_avs_risky? %>
                <%= "#{Spree.t(:error)}: #{avs_response_code[latest_payment.avs_response]}" %>
              <% else %>
                <%= Spree.t(:success) %>
              <% end %>
            </span>
          </td>
        </tr>
        <tr>
          <td><strong><%= Spree.t(:cvv_response) %>:</strong></td>
          <td>
              <span class="badge badge-<%= latest_payment.is_cvv_risky? ? 'void' : 'complete' %>">
                <% if latest_payment.is_cvv_risky? %>
                  <%= "#{Spree.t(:error)}: #{cvv_response_code[latest_payment.cvv_response_code]}" %>
                <% else %>
                  <%= Spree.t(:success) %>
                <% end %>
              </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
